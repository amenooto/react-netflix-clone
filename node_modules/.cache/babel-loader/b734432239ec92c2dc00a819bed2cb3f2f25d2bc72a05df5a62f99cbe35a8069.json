{"ast":null,"code":"import _regeneratorRuntime from\"/Users/hyeonholee/study/react-netfilx/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/hyeonholee/study/react-netfilx/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/hyeonholee/study/react-netfilx/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from\"react\";import{useLocation,useNavigate}from\"react-router-dom\";import axios from\"../../api/axios\";import{useDebounce}from\"../../hooks/useDebounce\";import\"./SearchPage.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function SearchPage(){var navigate=useNavigate();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),searchResults=_useState2[0],setSearchResults=_useState2[1];var useQuery=function useQuery(){return new URLSearchParams(useLocation().search);};var query=useQuery();var searchTerm=query.get(\"q\");// ko: 포퍼먼스를 위해\n// ja: フォーファーマンスのため、\nvar debouncedSearchTerm=useDebounce(searchTerm,500);// ko: 검색이 바뀔때마다 새로 찾아오기 위해\n// ja: 検索が変わったら新しい情報取得\nuseEffect(function(){if(debouncedSearchTerm){fetchSearchMovie(debouncedSearchTerm);}},[debouncedSearchTerm]);var fetchSearchMovie=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(searchTerm){var request;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log(\"searchTerm\",searchTerm);_context.prev=1;_context.next=4;return axios.get(\"/search/multi?include_adult=false&query=\".concat(searchTerm));case 4:request=_context.sent;console.log(request);setSearchResults(request.data.results);_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](1);console.log(\"error\",_context.t0);case 12:case\"end\":return _context.stop();}}},_callee,null,[[1,9]]);}));return function fetchSearchMovie(_x){return _ref.apply(this,arguments);};}();var renderSearchResults=function renderSearchResults(){return searchResults.length>0?/*#__PURE__*/_jsx(\"section\",{className:\"search-container\",children:searchResults.map(function(movie){if(movie.backdrop_path!==null&&movie.media_type!==\"person\"){var movieImageUrl=\"https://image.tmdb.org/t/p/w500\"+movie.backdrop_path;return/*#__PURE__*/_jsx(\"div\",{className:\"movie\",children:/*#__PURE__*/_jsx(\"div\",{onClick:function onClick(){return navigate(\"/\".concat(movie.id));},className:\"movie__column-poster\",children:/*#__PURE__*/_jsx(\"img\",{src:movieImageUrl,alt:\"movie\",className:\"movie__poster\"})})},movie.id);}})}):/*#__PURE__*/_jsx(\"section\",{className:\"no-results\",children:/*#__PURE__*/_jsx(\"div\",{className:\"no-results__text\",children:/*#__PURE__*/_jsxs(\"p\",{children:[\"\\uCC3E\\uACE0\\uC790\\uD558\\uB294 \\uAC80\\uC0C9\\uC5B4\\\"\",debouncedSearchTerm,\"\\\"\\uC5D0 \\uB9DE\\uB294 \\uC601\\uD654\\uAC00 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\"]})})});};return renderSearchResults();}","map":{"version":3,"names":["React","useEffect","useState","useLocation","useNavigate","axios","useDebounce","SearchPage","navigate","searchResults","setSearchResults","useQuery","URLSearchParams","search","query","searchTerm","get","debouncedSearchTerm","fetchSearchMovie","console","log","request","data","results","renderSearchResults","length","map","movie","backdrop_path","media_type","movieImageUrl","id"],"sources":["/Users/hyeonholee/study/react-netfilx/src/pages/SearchPage/index.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport axios from \"../../api/axios\";\nimport { useDebounce } from \"../../hooks/useDebounce\";\nimport \"./SearchPage.css\";\n\nexport default function SearchPage() {\n  const navigate = useNavigate();\n  const [searchResults, setSearchResults] = useState([]);\n\n  const useQuery = () => {\n    return new URLSearchParams(useLocation().search);\n  };\n\n  let query = useQuery();\n  const searchTerm = query.get(\"q\");\n\n  // ko: 포퍼먼스를 위해\n  // ja: フォーファーマンスのため、\n  const debouncedSearchTerm = useDebounce(searchTerm, 500);\n  // ko: 검색이 바뀔때마다 새로 찾아오기 위해\n  // ja: 検索が変わったら新しい情報取得\n  useEffect(() => {\n    if (debouncedSearchTerm) {\n      fetchSearchMovie(debouncedSearchTerm);\n    }\n  }, [debouncedSearchTerm]);\n\n  const fetchSearchMovie = async (searchTerm) => {\n    console.log(\"searchTerm\", searchTerm);\n    try {\n      const request = await axios.get(\n        `/search/multi?include_adult=false&query=${searchTerm}`\n      );\n      console.log(request);\n      setSearchResults(request.data.results);\n    } catch (error) {\n      console.log(\"error\", error);\n    }\n  };\n\n  const renderSearchResults = () => {\n    return searchResults.length > 0 ? (\n      <section className=\"search-container\">\n        {searchResults.map((movie) => {\n          if (movie.backdrop_path !== null && movie.media_type !== \"person\") {\n            const movieImageUrl =\n              \"https://image.tmdb.org/t/p/w500\" + movie.backdrop_path;\n            return (\n              <div className=\"movie\" key={movie.id}>\n                <div\n                  onClick={() => navigate(`/${movie.id}`)}\n                  className=\"movie__column-poster\"\n                >\n                  <img\n                    src={movieImageUrl}\n                    alt=\"movie\"\n                    className=\"movie__poster\"\n                  />\n                </div>\n              </div>\n            );\n          }\n        })}\n      </section>\n    ) : (\n      <section className=\"no-results\">\n        <div className=\"no-results__text\">\n          <p>\n            찾고자하는 검색어\"{debouncedSearchTerm}\"에 맞는 영화가 없습니다.\n          </p>\n        </div>\n      </section>\n    );\n  };\n\n  return renderSearchResults();\n}\n"],"mappings":"iYAAA,MAAOA,MAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,OAASC,WAAW,CAAEC,WAAW,KAAQ,kBAAkB,CAC3D,MAAOC,MAAK,KAAM,iBAAiB,CACnC,OAASC,WAAW,KAAQ,yBAAyB,CACrD,MAAO,kBAAkB,CAAC,wFAE1B,cAAe,SAASC,WAAU,EAAG,CACnC,GAAMC,SAAQ,CAAGJ,WAAW,EAAE,CAC9B,cAA0CF,QAAQ,CAAC,EAAE,CAAC,wCAA/CO,aAAa,eAAEC,gBAAgB,eAEtC,GAAMC,SAAQ,CAAG,QAAXA,SAAQ,EAAS,CACrB,MAAO,IAAIC,gBAAe,CAACT,WAAW,EAAE,CAACU,MAAM,CAAC,CAClD,CAAC,CAED,GAAIC,MAAK,CAAGH,QAAQ,EAAE,CACtB,GAAMI,WAAU,CAAGD,KAAK,CAACE,GAAG,CAAC,GAAG,CAAC,CAEjC;AACA;AACA,GAAMC,oBAAmB,CAAGX,WAAW,CAACS,UAAU,CAAE,GAAG,CAAC,CACxD;AACA;AACAd,SAAS,CAAC,UAAM,CACd,GAAIgB,mBAAmB,CAAE,CACvBC,gBAAgB,CAACD,mBAAmB,CAAC,CACvC,CACF,CAAC,CAAE,CAACA,mBAAmB,CAAC,CAAC,CAEzB,GAAMC,iBAAgB,4FAAG,iBAAOH,UAAU,gIACxCI,OAAO,CAACC,GAAG,CAAC,YAAY,CAAEL,UAAU,CAAC,CAAC,sCAEdV,MAAK,CAACW,GAAG,mDACcD,UAAU,EACtD,QAFKM,OAAO,eAGbF,OAAO,CAACC,GAAG,CAACC,OAAO,CAAC,CACpBX,gBAAgB,CAACW,OAAO,CAACC,IAAI,CAACC,OAAO,CAAC,CAAC,+EAEvCJ,OAAO,CAACC,GAAG,CAAC,OAAO,aAAQ,CAAC,oEAE/B,kBAXKF,iBAAgB,4CAWrB,CAED,GAAMM,oBAAmB,CAAG,QAAtBA,oBAAmB,EAAS,CAChC,MAAOf,cAAa,CAACgB,MAAM,CAAG,CAAC,cAC7B,gBAAS,SAAS,CAAC,kBAAkB,UAClChB,aAAa,CAACiB,GAAG,CAAC,SAACC,KAAK,CAAK,CAC5B,GAAIA,KAAK,CAACC,aAAa,GAAK,IAAI,EAAID,KAAK,CAACE,UAAU,GAAK,QAAQ,CAAE,CACjE,GAAMC,cAAa,CACjB,iCAAiC,CAAGH,KAAK,CAACC,aAAa,CACzD,mBACE,YAAK,SAAS,CAAC,OAAO,uBACpB,YACE,OAAO,CAAE,yBAAMpB,SAAQ,YAAKmB,KAAK,CAACI,EAAE,EAAG,EAAC,CACxC,SAAS,CAAC,sBAAsB,uBAEhC,YACE,GAAG,CAAED,aAAc,CACnB,GAAG,CAAC,OAAO,CACX,SAAS,CAAC,eAAe,EACzB,EACE,EAVoBH,KAAK,CAACI,EAAE,CAW9B,CAEV,CACF,CAAC,CAAC,EACM,cAEV,gBAAS,SAAS,CAAC,YAAY,uBAC7B,YAAK,SAAS,CAAC,kBAAkB,uBAC/B,2EACad,mBAAmB,wEAC5B,EACA,EAET,CACH,CAAC,CAED,MAAOO,oBAAmB,EAAE,CAC9B"},"metadata":{},"sourceType":"module","externalDependencies":[]}